<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CLR Overlay Draft Test</title>
  <style>
    body {
      background: #002244;
      color: #fff;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    .draft-container {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 60px;
    }
    .team {
      text-align: center;
    }
    .brawler {
      width: 80px;
      height: 80px;
      margin: 5px;
      border-radius: 10px;
      background: #222;
      display: inline-block;
      background-size: cover;
      background-position: center;
    }
    h2 {
      margin-bottom: 10px;
    }
    #map-name {
      font-size: 24px;
      margin-top: 20px;
      color: #ffcc00;
    }
  </style>
</head>
<body>
  <h1>Transcending Void Draft Overlay Test</h1>
  <div id="map-name"></div>
  <div class="draft-container">
    <div class="team" id="teamA">
      <h2 id="teamAName">Team A</h2>
      <div id="teamABans"></div>
      <div id="teamAPicks"></div>
    </div>
    <div class="team" id="teamB">
      <h2 id="teamBName">Team B</h2>
      <div id="teamBBans"></div>
      <div id="teamBPicks"></div>
    </div>
  </div>

  <script>
    const bountyId = new URLSearchParams(window.location.search).get("bountyId");
    const matchId = new URLSearchParams(window.location.search).get("matchId");

    async function loadOverlay() {
      const res = await fetch(`/data?bountyId=${bountyId}&matchId=${matchId}`);
      const data = await res.json();

      if (data.error) {
        document.body.innerHTML = `<h1>⚠️ ${data.error}</h1>`;
        return;
      }

      const match = data.body?.matches?.[0];
      if (!match) {
        document.body.innerHTML = `<h1>No match data found</h1>`;
        return;
      }

      document.getElementById("map-name").innerText = match.map?.name || "Unknown Map";
      document.getElementById("teamAName").innerText = match.entrantA?.name || "Team A";
      document.getElementById("teamBName").innerText = match.entrantB?.name || "Team B";

      renderDraft(match.entrantA, "A");
      renderDraft(match.entrantB, "B");
    }

    function renderDraft(team, side) {
      const bans = team.bans || [];
      const picks = team.picks || [];

      const bansContainer = document.getElementById(`team${side}Bans`);
      const picksContainer = document.getElementById(`team${side}Picks`);

      bans.forEach(b => {
        const el = document.createElement("div");
        el.className = "brawler";
        el.style.backgroundImage = `url(${b.brawler?.imageUrl || ""})`;
        bansContainer.appendChild(el);
      });

      picks.forEach(p => {
        const el = document.createElement("div");
        el.className = "brawler";
        el.style.backgroundImage = `url(${p.brawler?.imageUrl || ""})`;
        picksContainer.appendChild(el);
      });
    }

    loadOverlay();
  </script>
</body>
</html>


